网络层笔记

网络层提供的服务

网络层只提供简单灵活的，无连接的，尽最大努力交付的数据报服务。之所以不选择虚电路，类似电信网的可靠传输的方式，是因为电信网两端的用户话机是非常简单的，而网络两端的计算机是拥有处理差错能力极强的智能计算机，所以可以采用不同的网络结构。

IP协议分组头部

其中有一个部分是首部长度，意思是：占用4个比特，也就是4位，但是每位都是代表32位字，也就是代表4个字节，如果四位代表的是1111，也就是最大的二进制数，但是代表的长度是15x32bit=15x4Byte=60字节。因为IP分组的最小报文头部是20字节，所以首部长度最小应该是0101（十进制的5）。这也暗示了一个现象，就是IP分组头部长度必须是4个字节的整数倍的。

其中有一个是总长度，这个是代表的首部和数据的总长度，不是代表的32位字的，就是代表8位字，1个字节。

其中还有一个是标识，因为IP分组如果分片时候，要指定同一分组分片后的许多小分组是有相同的标识的，以便可以在接收端合片，这里的标识并不是像TCP的序号一样为了在接收端排序无序的报文段，而仅仅是一个身份的标识，所以分组之后的小分组都是有着同一个标识的。

片偏移：代表的是一个大的分组分成许多个连续的小分组之后，每一个小分组相对于原来大分组的数据头部的偏移量。具体例子请看《计算机网络》P128

IP地址的演化以及各个阶段的路由

IP地址的演化，分为三个历史：第一个是，一个IP地址最初的版本是由网络号和主机号两部分组成，网络号占一个，两个，三个字节的分别为A,B,C类地址。但是这样做的不好的地方在于，某些网络过大并且这些过大的网络都处于同一个网络下，例如一个A类地址有支持$2^{24}-2$个主机号，并且这些主机号在同一网络下，可以互相通信，即使现在最大的公司也没有这么多的员工和主机，并且一个公司也无法忍受，各个部门是可以互相直接在同一个网络下的。所以催生了网络的再划分，即原来的IP地址组成是<网络号，主机号>，现在的IP地址组成为<网络号，子网号，主机号>，将原来的主机号划分为子网号和主机号两部分。这波操作叫做划分子网。通过添加子网掩码来实现的，同样的路由过程也有相应的改变，具体参照《计算机网络》P135 4-9图，和P139例题4-4。第三个阶段是CIDR。